     1                                  [org 0x0100]
     2                                  
     3 00000000 E90400                      jmp start
     4                                  
     5 00000003 00000000                    _bits: dw 0, 0
     6                                  
     7                                      start:
     8 00000007 B90000                          mov cx, 0
     9 0000000A B8CDAB                          mov ax, 0xABCD
    10 0000000D BB0080                          mov bx, 1000000000000000b
    11 00000010 BA0088                          mov dx, 1000100000000000b
    12 00000013 BE0000                          mov si, 0
    13 00000016 BF0000                          mov di, 0
    14 00000019 BD0000                          mov bp, 0
    15                                      
    16                                      loop1:
    17 0000001C 85C3                            test bx, ax
    18 0000001E 741F                            jz save0
    19 00000020 7530                            jnz save1
    20                                  
    21                                      l1:
    22 00000022 C1EB04                          shr bx, 4
    23 00000025 EBF5                            jmp loop1
    24                                  
    25                                      l2:
    26 00000027 BD0000                          mov bp, 0
    27                                  
    28 0000002A C1E303                          shl bx, 3
    29 0000002D E93D00                          jmp swap
    30                                  
    31                                      l3:
    32 00000030 41                              inc cx
    33 00000031 81F90400                        cmp cx, 4
    34 00000035 742E                            jz update                       ; After the nibbles in ah are swapped, the masks in bx and dx are updated
    35 00000037 81F90800                        cmp cx, 8
    36 0000003B 7443                            jz end
    37                                  
    38 0000003D EBDD                            jmp loop1
    39                                  
    40                                  
    41                                      save0:
    42 0000003F C784[0300]0000                  mov word [_bits + si], 0
    43 00000045 81C60200                        add si, 2
    44 00000049 45                              inc bp
    45 0000004A 81FD0200                        cmp bp, 2
    46 0000004E 74D7                            jz l2
    47 00000050 EBD0                            jmp l1
    48                                      
    49                                      save1:
    50 00000052 C784[0300]0100                  mov word [_bits + si], 1
    51 00000058 81C60200                        add si, 2
    52 0000005C 45                              inc bp
    53 0000005D 81FD0200                        cmp bp, 2
    54 00000061 74C4                            jz l2
    55 00000063 EBBD                            jmp l1
    56                                  
    57                                      update:
    58 00000065 BB8000                          mov bx, 0000000010000000b
    59 00000068 BA8800                          mov dx, 0000000010001000b
    60                                  
    61 0000006B EBAF                            jmp loop1
    62                                  
    63                                      swap:
    64 0000006D BE0000                          mov si, 0
    65                                  
    66 00000070 8B3E[0300]                      mov di, [_bits]
    67 00000074 3B3E[0500]                      cmp di, [_bits + 2]
    68 00000078 7402                            jz l4                           ; If the bits are same then do nothing
    69                                  
    70 0000007A 31D0                            xor ax, dx
    71                                  
    72                                      l4:
    73 0000007C D1EA                            shr dx, 1
    74 0000007E EBB0                            jmp l3
    75                                  
    76                                      end:
    77 00000080 B8004C                          mov ax, 0x4c00
    78 00000083 CD21                            int 0x21 
    79                                  
    80                                          
